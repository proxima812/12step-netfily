---
const btn_player =
 "py-[2px] rounded-[5px] px-[10px] hover:bg-slate-200 focus:bg-green-100";
---

<button
 id="open-speech"
 class="lg:hidden inline-block p-[10px] bg-white focus:bg-slate-200 focus: rounded-[10px]"
 >ğŸ› ĞĞ·Ğ²ÑƒÑ‡ĞºĞ°</button
>

<div
 class="hidden inline-flex p-[5px] bg-slate-100 rounded-[5px] lg:inline-flex flex-wrap gap-[5px]"
 id="spch"
>
 <select id="voices" class="hidden" class={btn_player}></select>
 <button id="start" aria-label="ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ" class={btn_player}>ğŸ¤ ĞĞ·Ğ²ÑƒÑ‡Ğ¸Ñ‚ÑŒ</button>
 <button id="pause" aria-label="ĞŸĞ°ÑƒĞ·Ğ°" class={"text-[22px] " + btn_player}>â¸</button>
 <button id="resume" aria-label="ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ¸Ñ‚ÑŒ" class={"text-[22px] " + btn_player}
  >â©</button
 >
 <button id="cancel" aria-label="Ğ—Ğ°ĞºĞ¾Ğ½Ñ‡Ğ¸Ñ‚ÑŒ" class={"text-[20px] " + btn_player}>âŒ</button
 >
</div>

<script lang="js" is:inline>
 // Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ° SpeechSynthesisUtterance
 let speech = new SpeechSynthesisUtterance();
 speech.lang = "ru-RU";
 let voices = []; // Ğ³Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¼Ğ°ÑÑĞ¸Ğ² Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… Ğ³Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²
 window.speechSynthesis.onvoiceschanged = () => {
  // ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ° Ğ³Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²
  const voices = window.speechSynthesis.getVoices();

  // Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ³Ğ¾Ğ»Ğ¾ÑĞ¾Ğ² Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ° Ñ€ÑƒÑÑĞºĞ¾Ğ¼ ÑĞ·Ñ‹ĞºĞµ
  const russianVoices = voices.filter((voice) => voice.lang.includes("ru"));

  // ĞŸĞµÑ€Ğ²Ğ¾Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ³Ğ¾Ğ»Ğ¾ÑĞ° Ğ² Ğ¼Ğ°ÑÑĞ¸Ğ²Ğµ
  speech.voice = russianVoices[0];

  // Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° ÑĞ¿Ğ¸ÑĞºĞ° Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ° Ğ³Ğ¾Ğ»Ğ¾ÑĞ¾Ğ² (Ğ·Ğ°Ğ´Ğ°ĞµĞ¼ Ğ¸Ğ½Ğ´ĞµĞºÑ Ğ² ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ² Ğ´Ğ°Ğ»ÑŒĞ½ĞµĞ¹ÑˆĞµĞ¼ Ğ¿Ğ¾Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¸ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¼ Ğ³Ğ¾Ğ»Ğ¾ÑĞ° Ğ¿Ğ¾ÑÑ€ĞµĞ´ÑÑ‚Ğ²Ğ¾Ğ¼ Ğ¼ĞµĞ½Ñ Select)
  const voiceSelect = document.querySelector("#voices");
  russianVoices.forEach(
   (voice, i) => (voiceSelect.options[i] = new Option(voice.name, i))
  );
 };
 document.querySelector("#voices").addEventListener("change", () => {
  // ĞŸÑ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¸ Ğ³Ğ¾Ğ»Ğ¾ÑĞ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¼ĞµĞ½Ñ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ° (ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğµ ÑĞ²Ğ»ÑĞµÑ‚ÑÑ Ğ¸Ğ½Ğ´ĞµĞºÑĞ¾Ğ¼ Ğ³Ğ¾Ğ»Ğ¾ÑĞ° Ğ² Ğ³Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ¼Ğ°ÑÑĞ¸Ğ²Ğµ Ğ³Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²)
  speech.voice = voices[document.querySelector("#voices").value];
 });

 document.querySelector("#start").addEventListener("click", () => {
  // Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° ÑĞ²Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° text ÑĞ¾ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸ĞµĞ¼ textarea
  speech.text = document.querySelector("#spech-content").textContent;

  // Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¾Ğ·Ğ²ÑƒÑ‡ĞºĞ¸
  window.speechSynthesis.speak(speech);
 });

 document.querySelector("#pause").addEventListener("click", () => {
  // ĞŸÑ€Ğ¸Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° ÑĞºĞ·ĞµĞ¼Ğ¿Ğ»ÑÑ€Ğ° speechSynthesis
  window.speechSynthesis.pause();
 });

 document.querySelector("#resume").addEventListener("click", () => {
  // Ğ’Ğ¾Ğ·Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ ÑĞºĞ·ĞµĞ¼Ğ¿Ğ»ÑÑ€Ğ° speechSynthesis
  window.speechSynthesis.resume();
 });

 document.querySelector("#cancel").addEventListener("click", () => {
  // ĞÑ‚Ğ¼ĞµĞ½Ğ° ÑĞºĞ·ĞµĞ¼Ğ¿Ğ»ÑÑ€Ğ° speechSynthesis
  window.speechSynthesis.cancel();
 });
</script>
<script lang="js" is:inline>
 const spch = document.querySelector("#spch");
 const speech_open = document.querySelector("#open-speech");
 const isHidden_spch = false;
 if (!isHidden_spch) {
  speech_open.addEventListener("click", () => {
   spch.classList.toggle("hidden");
  });
 }
</script>
